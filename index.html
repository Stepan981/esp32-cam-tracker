<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32-CAM Video Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            overflow: hidden;
            background: #000;
        }
        .video-container iframe,
        .video-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .auth-form {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }
        .sidebar {
            transition: all 0.3s ease;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
                height: 100vh;
            }
            .sidebar.open {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Mobile Menu Button -->
    <button id="menuBtn" class="md:hidden fixed top-4 left-4 z-50 bg-blue-600 p-2 rounded-lg">
        <i class="fas fa-bars text-white"></i>
    </button>

    <!-- Sidebar -->
    <div id="sidebar" class="sidebar bg-gray-800 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 md:relative">
        <div class="flex items-center space-x-2 px-4">
            <i class="fas fa-camera text-blue-500 text-2xl"></i>
            <h1 class="text-xl font-bold">ESP32-CAM Tracker</h1>
        </div>
        
        <nav>
            <div id="guestLinks" class="px-4">
                <a href="#" onclick="showAuthForm('login')" class="flex items-center space-x-2 py-2 px-4 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-sign-in-alt text-blue-400"></i>
                    <span>Увійти</span>
                </a>
                <a href="#" onclick="showAuthForm('register')" class="flex items-center space-x-2 py-2 px-4 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-user-plus text-green-400"></i>
                    <span>Реєстрація</span>
                </a>
            </div>
            
            <div id="userLinks" class="px-4 hidden">
                <a href="#" class="flex items-center space-x-2 py-2 px-4 rounded-lg bg-gray-700">
                    <i class="fas fa-video text-blue-400"></i>
                    <span>Моніторинг</span>
                </a>
                <a href="#" class="flex items-center space-x-2 py-2 px-4 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-history text-yellow-400"></i>
                    <span>Архів</span>
                </a>
                <a href="#" class="flex items-center space-x-2 py-2 px-4 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-cog text-gray-400"></i>
                    <span>Налаштування</span>
                </a>
                <a href="#" onclick="logout()" class="flex items-center space-x-2 py-2 px-4 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-sign-out-alt text-red-400"></i>
                    <span>Вийти</span>
                </a>
            </div>
        </nav>
        
        <div class="px-4">
            <h3 class="text-sm uppercase text-gray-500 mb-2">Камери</h3>
            <div id="cameraList" class="space-y-1">
                <!-- Cameras will be added dynamically -->
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="md:ml-64 p-4">
        <!-- Auth Forms Overlay -->
        <div id="authOverlay" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center hidden">
            <div class="auth-form rounded-xl p-8 w-full max-w-md relative">
                <button onclick="hideAuthForm()" class="absolute top-4 right-4 text-gray-300 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
                
                <!-- Login Form -->
                <div id="loginForm" class="space-y-4">
                    <h2 class="text-2xl font-bold text-center mb-6">Увійти в систему</h2>
                    <div>
                        <label class="block text-sm font-medium mb-1">Електронна пошта</label>
                        <input type="email" id="loginEmail" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Пароль</label>
                        <input type="password" id="loginPassword" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button onclick="login()" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded-lg font-medium transition duration-200">
                        Увійти
                    </button>
                    <p class="text-center text-sm text-gray-300">
                        Немає акаунта? <a href="#" onclick="showAuthForm('register')" class="text-blue-400 hover:underline">Зареєструватись</a>
                    </p>
                </div>
                
                <!-- Register Form -->
                <div id="registerForm" class="space-y-4 hidden">
                    <h2 class="text-2xl font-bold text-center mb-6">Створити акаунт</h2>
                    <div>
                        <label class="block text-sm font-medium mb-1">Ім'я</label>
                        <input type="text" id="registerName" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Електронна пошта</label>
                        <input type="email" id="registerEmail" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Пароль</label>
                        <input type="password" id="registerPassword" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Підтвердіть пароль</label>
                        <input type="password" id="registerConfirmPassword" class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button onclick="register()" class="w-full bg-green-600 hover:bg-green-700 py-2 rounded-lg font-medium transition duration-200">
                        Зареєструватись
                    </button>
                    <p class="text-center text-sm text-gray-300">
                        Вже маєте акаунт? <a href="#" onclick="showAuthForm('login')" class="text-blue-400 hover:underline">Увійти</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="flex justify-between items-center mb-6">
            <div>
                <h2 id="pageTitle" class="text-2xl font-bold">Моніторинг камер</h2>
                <p id="statusText" class="text-gray-400 text-sm">Будь ласка, увійдіть для перегляду</p>
            </div>
            <div id="userInfo" class="hidden flex items-center space-x-2 bg-gray-800 px-4 py-2 rounded-lg">
                <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center">
                    <i class="fas fa-user"></i>
                </div>
                <span id="userName">Користувач</span>
            </div>
        </div>

        <!-- Video Content -->
        <div id="videoContent" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-gray-800 rounded-xl overflow-hidden">
                    <div class="video-container">
                        <img id="cameraFeed" src="https://via.placeholder.com/800x450?text=ESP32-CAM+Feed" alt="Camera Feed">
                    </div>
                    <div class="p-4">
                        <h3 class="font-medium text-lg mb-2">Основна камера</h3>
                        <div class="flex space-x-2">
                            <button class="bg-blue-600 hover:bg-blue-700 px-4 py-1 rounded-lg">
                                <i class="fas fa-expand mr-1"></i> На весь екран
                            </button>
                            <button class="bg-gray-700 hover:bg-gray-600 px-4 py-1 rounded-lg">
                                <i class="fas fa-camera mr-1"></i> Зробити знімок
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-xl p-4">
                    <h3 class="font-medium text-lg mb-4">Керування камерою</h3>
                    <div class="grid grid-cols-3 gap-3 mb-6">
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-home"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-lightbulb"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-stop"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-arrow-down"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-camera"></i>
                        </button>
                        <button class="bg-gray-700 hover:bg-gray-600 p-3 rounded-lg">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Якість відео</label>
                            <select class="w-full bg-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>Висока (1080p)</option>
                                <option selected>Середня (720p)</option>
                                <option>Низька (480p)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-1">Розмір кадру (мс)</label>
                            <input type="range" min="100" max="5000" value="1000" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-8">
                <h3 class="font-medium text-lg mb-4">Останні знімки</h3>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <img src="https://via.placeholder.com/300x200?text=Snapshot+1" alt="Snapshot" class="w-full h-32 object-cover">
                        <div class="p-2 text-xs text-gray-400">12.05.2023 14:30</div>
                    </div>
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <img src="https://via.placeholder.com/300x200?text=Snapshot+2" alt="Snapshot" class="w-full h-32 object-cover">
                        <div class="p-2 text-xs text-gray-400">12.05.2023 10:15</div>
                    </div>
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <img src="https://via.placeholder.com/300x200?text=Snapshot+3" alt="Snapshot" class="w-full h-32 object-cover">
                        <div class="p-2 text-xs text-gray-400">11.05.2023 18:45</div>
                    </div>
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <img src="https://via.placeholder.com/300x200?text=Snapshot+4" alt="Snapshot" class="w-full h-32 object-cover">
                        <div class="p-2 text-xs text-gray-400">11.05.2023 08:20</div>
                    </div>
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <img src="https://via.placeholder.com/300x200?text=Snapshot+5" alt="Snapshot" class="w-full h-32 object-cover">
                        <div class="p-2 text-xs text-gray-400">10.05.2023 22:10</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Guest Content -->
        <div id="guestContent" class="flex flex-col items-center justify-center py-12 text-center">
            <div class="max-w-md">
                <i class="fas fa-camera text-6xl text-blue-500 mb-6"></i>
                <h2 class="text-3xl font-bold mb-4">Відстежуйте ваші камери ESP32-CAM</h2>
                <p class="text-gray-400 mb-8">Увійдіть у свій акаунт або зареєструйтеся, щоб отримати доступ до потокового відео та керування вашими камерами.</p>
                <div class="flex space-x-4 justify-center">
                    <button onclick="showAuthForm('login')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-medium">
                        Увійти
                    </button>
                    <button onclick="showAuthForm('register')" class="bg-gray-700 hover:bg-gray-600 px-6 py-2 rounded-lg font-medium">
                        Реєстрація
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if user is logged in
        let currentUser = JSON.parse(localStorage.getItem('currentUser'));
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            addSampleCameras();
            
            // Mobile menu toggle
            document.getElementById('menuBtn').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('open');
            });
        });
        
        // Add some sample cameras
        function addSampleCameras() {
            const cameraList = document.getElementById('cameraList');
            
            const cameras = [
                { name: 'Вхідні двері', active: true },
                { name: 'Двір', active: false },
                { name: 'Гараж', active: false }
            ];
            
            cameraList.innerHTML = '';
            
            cameras.forEach(camera => {
                const cameraItem = document.createElement('a');
                cameraItem.href = '#';
                cameraItem.className = `flex items-center space-x-2 py-2 px-4 rounded-lg ${camera.active ? 'bg-gray-700' : 'hover:bg-gray-700'}`;
                cameraItem.innerHTML = `
                    <i class="fas ${camera.active ? 'fa-video text-green-500' : 'fa-video-slash text-gray-500'}"></i>
                    <span>${camera.name}</span>
                `;
                cameraList.appendChild(cameraItem);
            });
        }
        
        // Update UI based on auth state
        function updateUI() {
            if (currentUser) {
                document.getElementById('guestLinks').classList.add('hidden');
                document.getElementById('userLinks').classList.remove('hidden');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('videoContent').classList.remove('hidden');
                document.getElementById('guestContent').classList.add('hidden');
                document.getElementById('statusText').textContent = `Вітаємо, ${currentUser.name}!`;
            } else {
                document.getElementById('guestLinks').classList.remove('hidden');
                document.getElementById('userLinks').classList.add('hidden');
                document.getElementById('userInfo').classList.add('hidden');
                document.getElementById('videoContent').classList.add('hidden');
                document.getElementById('guestContent').classList.remove('hidden');
                document.getElementById('statusText').textContent = 'Будь ласка, увійдіть для перегляду';
            }
        }
        
        // Show auth form
        function showAuthForm(formType) {
            document.getElementById('authOverlay').classList.remove('hidden');
            
            if (formType === 'login') {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('registerForm').classList.add('hidden');
            } else {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('registerForm').classList.remove('hidden');
            }
            
            // Close mobile menu if open
            document.getElementById('sidebar').classList.remove('open');
        }
        
        // Hide auth form
        function hideAuthForm() {
            document.getElementById('authOverlay').classList.add('hidden');
        }
        
        // Login function
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple validation
            if (!email || !password) {
                alert('Будь ласка, заповніть всі поля');
                return;
            }
            
            // Check if user exists
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                updateUI();
                hideAuthForm();
            } else {
                alert('Невірний email або пароль');
            }
        }
        
        // Register function
        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            // Simple validation
            if (!name || !email || !password || !confirmPassword) {
                alert('Будь ласка, заповніть всі поля');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Паролі не співпадають');
                return;
            }
            
            // Check if user already exists
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const userExists = users.some(u => u.email === email);
            
            if (userExists) {
                alert('Користувач з таким email вже існує');
                return;
            }
            
            // Create new user
            const newUser = {
                id: Date.now(),
                name,
                email,
                password
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Auto login
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            updateUI();
            hideAuthForm();
        }
        
        // Logout function
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUI();
        }
    </script>
</body>
</html>
